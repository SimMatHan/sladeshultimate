import { NavLink, useLocation } from 'react-router-dom'

const tabs = [
  {
    to: '/home',
    label: 'Home',
    Icon: HomeIcon,
    end: true,
    additionalActivePaths: [
      (pathname) => pathname.startsWith('/drink/'),
      (pathname) => pathname === '/map' || pathname.startsWith('/map/'),
      (pathname) => pathname === '/achievements',
    ],
  },
  { to: '/sladesh', label: 'Sladesh', Icon: SparkIcon },
  { to: '/leaderboard', label: 'Score', Icon: TrophyIcon },
  { to: '/more', label: 'More', Icon: MenuIcon, additionalActivePaths: ['/manage-channels', '/manage-profile', '/admin'] },
]

function Item({ to, label, Icon, end, additionalActivePaths = [] }) {
  const location = useLocation()
  
  return (
    <NavLink
      to={to}
      end={end}
      aria-label={label}
      className={({ isActive }) => {
        const isAdditionalActive = additionalActivePaths.some((extra) => {
          if (typeof extra === 'function') {
            return extra(location.pathname)
          }
          return location.pathname === extra
        })
        const shouldBeActive = isActive || isAdditionalActive
        return `flex flex-col items-center justify-center text-xs transition-colors ${
          shouldBeActive 
            ? 'text-[color:var(--brand,#FF385C)]' 
            : 'text-[color:var(--muted,#717171)]'
        }`
      }}
    >
      <span className="leading-none mb-1" aria-hidden="true">
        <Icon className="w-6 h-6" focusable="false" />
      </span>
      <span className="leading-none text-[11px] font-medium">{label}</span>
    </NavLink>
  )
}

export default function TabBar() {
  return (
    <nav 
      className="h-16 grid grid-cols-4 bg-[var(--surface)]"
      aria-label="Primary navigation"
    >
      {tabs.map((tab) => (
        <Item key={tab.to} {...tab} />
      ))}
    </nav>
  )
}

function HomeIcon(props) {
  return (
    <svg
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      strokeWidth="1.6"
      strokeLinecap="round"
      strokeLinejoin="round"
      {...props}
    >
      <path d="M3.5 11 12 4l8.5 7" />
      <path d="M6.5 12.5v7a1.5 1.5 0 0 0 1.5 1.5H11v-4.5h2V21h3a1.5 1.5 0 0 0 1.5-1.5v-7" />
    </svg>
  )
}

function TrophyIcon(props) {
  return (
    <svg
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      strokeWidth="1.6"
      strokeLinecap="round"
      strokeLinejoin="round"
      {...props}
    >
      <path d="M7 4h10v2.2a4 4 0 0 1-4 4h-2a4 4 0 0 1-4-4V4Z" />
      <path d="M5 6a3 3 0 0 0 3 3" />
      <path d="M19 6a3 3 0 0 1-3 3" />
      <path d="M12 10v4.5" />
      <path d="M9.5 14.5h5" />
      <path d="M9 19h6" />
    </svg>
  )
}

function SparkIcon(props) {
  return (
    <svg viewBox="0 0 24 24" {...props}>
      <g transform="scale(0.03125)">
        <path
          d="M210.375 197.625C210.754 197.728 211.133 197.832 211.523 197.939C218.988 200.14 225.465 205.043 231 210.375C231.198 210.563 231.396 210.751 231.6 210.945C234.841 214.04 237.71 217.275 240.375 220.875C240.531 221.081 240.688 221.288 240.849 221.501C244.825 226.756 248.053 232.524 250.879 238.47C251.131 239 251.387 239.529 251.645 240.057C256.291 249.594 259.059 259.716 261.085 270.093C263.875 284.298 269.887 297.847 282.231 306.172C289.51 310.961 297.68 313.85 306.375 314.625C306.932 314.686 306.932 314.686 307.5 314.749C310.208 315.013 312.914 315.037 315.633 315.046C315.994 315.048 316.354 315.05 316.726 315.052C321.602 315.237 321.602 315.237 325.711 313.031C326.093 312.685 326.476 312.341 326.861 311.998C327.063 311.815 327.266 311.632 327.475 311.443C328.645 310.42 329.886 309.491 331.125 308.554C331.392 308.351 331.66 308.148 331.935 307.939C332.789 307.291 333.644 306.645 334.5 306C334.8 305.773 335.1 305.545 335.409 305.312C342.115 300.242 348.909 295.33 355.875 290.625C356.115 290.462 356.355 290.299 356.602 290.132C358.225 289.032 359.859 287.948 361.5 286.875C361.787 286.687 362.074 286.499 362.37 286.306C370.477 281.026 378.837 276.055 387.375 271.5C387.597 271.381 387.819 271.262 388.048 271.14C399.393 265.153 411.462 260.044 423.96 257.095C424.799 256.893 425.631 256.675 426.463 256.447C427.925 256.048 429.394 255.697 430.875 255.375C431.128 255.318 431.38 255.261 431.64 255.203C444.496 252.472 458.659 253.807 471 258C471.267 258.087 471.533 258.175 471.808 258.266C482.137 261.702 490.828 268.492 495.844 278.226C495.967 278.463 496.091 278.7 496.218 278.944C497.984 282.506 498.578 285.992 498.539 289.945C498.536 290.357 498.533 290.77 498.53 291.195C498.466 294.269 498.094 296.975 497.145 299.913C496.694 301.311 496.275 302.72 495.849 304.126C495.616 304.89 495.38 305.653 495.14 306.416C494.599 308.147 494.103 309.818 493.875 311.625C494.072 311.667 494.268 311.709 494.471 311.752C499.397 313.006 503.984 315.763 507.75 319.125C508.06 319.382 508.371 319.639 508.69 319.904C514.376 324.738 518.374 331.581 519.078 339.076C519.487 345.805 517.684 351.822 515.678 358.167C514.433 362.123 513.346 366.125 512.25 370.125C512.713 370.139 512.713 370.139 513.185 370.153C522.01 370.488 530.448 374.814 536.518 381.115C541.321 386.772 543.164 394.087 542.732 401.363C542.164 406.724 540.103 412.029 538.428 417.125C537.512 419.939 536.701 422.784 535.875 425.625C536.25 425.442 536.625 425.259 537.012 425.07C549.678 418.897 549.677 418.897 555.247 416.243C558.107 414.88 560.96 413.503 563.812 412.125C567.789 410.202 571.771 408.291 575.757 406.387C581.19 403.791 586.617 401.182 592.039 398.562C593.635 397.791 595.233 397.02 596.83 396.249C597.666 395.846 598.501 395.443 599.337 395.039C604.023 392.776 608.729 390.578 613.5 388.5C613.5 388.252 613.5 388.005 613.5 387.75C614.234 387.513 614.968 387.279 615.703 387.046C616.112 386.916 616.521 386.785 616.942 386.651C626.049 384.1 634.861 385.456 643.122 389.846C651.575 394.856 657.688 403.915 660.375 413.25C662.204 421.322 660.117 429.106 655.81 435.943C652.915 440.275 649.529 443.863 645.375 447C645.031 447.264 644.688 447.528 644.333 447.801C633.084 456.034 618.781 460.856 606.02 466.21C597.145 469.936 588.396 473.892 579.75 478.125C579.374 478.308 578.997 478.491 578.609 478.679C572.993 481.416 567.521 484.35 562.125 487.5C561.81 487.683 561.495 487.867 561.171 488.056C552.741 492.992 544.587 498.342 536.625 504C536.313 504.221 536.001 504.442 535.68 504.669C532.125 507.193 528.651 509.796 525.241 512.512C524.223 513.318 523.194 514.108 522.164 514.898C521.864 515.128 521.864 515.128 521.559 515.363C521.157 515.671 520.755 515.979 520.353 516.287C519.339 517.065 518.326 517.845 517.312 518.625C516.906 518.937 516.5 519.25 516.094 519.562C515.893 519.717 515.692 519.871 515.484 520.031C502.383 530.109 502.383 530.109 489.281 540.187C489.08 540.342 488.879 540.496 488.672 540.655C488.265 540.969 487.857 541.282 487.45 541.596C486.453 542.363 485.456 543.13 484.459 543.897C483.867 544.353 483.275 544.809 482.682 545.263C481.523 546.152 480.371 547.047 479.224 547.951C476.078 550.415 472.911 552.671 469.421 554.623C468.778 554.984 468.141 555.355 467.505 555.728C460.544 559.652 452.694 562.663 444.984 564.75C444.631 564.845 444.278 564.941 443.915 565.04C440.515 565.941 437.087 566.606 433.625 567.215C432.854 567.356 432.086 567.515 431.319 567.676C404.565 573.275 373.515 569.279 350.25 554.625C342.282 549.37 335.593 542.659 328.882 535.93C327.93 534.976 326.976 534.024 326.021 533.072C325.406 532.457 324.791 531.841 324.176 531.225C323.895 530.945 323.615 530.666 323.326 530.377C321.803 528.848 320.344 527.283 318.935 525.648C318.301 524.914 317.647 524.203 316.98 523.5C316.747 523.252 316.513 523.005 316.273 522.75C316.038 522.502 315.804 522.255 315.562 522C312.96 519.252 310.473 516.416 308.016 513.539C306.61 511.895 305.199 510.255 303.78 508.623C300.455 504.796 297.158 500.964 294.047 496.961C292.878 495.463 291.673 494.005 290.437 492.562C288.477 490.27 286.612 487.913 284.762 485.532C284.259 484.886 283.753 484.243 283.245 483.6C280.774 480.472 278.345 477.312 275.93 474.141C275.201 473.185 274.47 472.231 273.738 471.278C271.249 468.028 268.778 464.773 266.421 461.425C265.767 460.496 265.1 459.576 264.426 458.66C256.428 447.763 249.297 436.35 243.393 424.18C242.966 423.305 242.532 422.434 242.098 421.562C233.776 404.695 227.747 386.749 221.625 369C221.53 368.725 221.435 368.449 221.337 368.166C221.06 367.362 220.783 366.559 220.506 365.755C220.418 365.502 220.331 365.248 220.241 364.987C219.84 363.822 219.439 362.657 219.04 361.491C218.39 359.596 217.726 357.711 217.014 355.839C216.41 354.206 215.886 352.545 215.344 350.891C214.81 349.273 214.247 347.671 213.641 346.078C213.241 345.021 212.863 343.955 212.484 342.89C212.321 342.434 212.159 341.977 211.991 341.507C211.68 340.633 211.373 339.758 211.068 338.882C210.029 335.917 208.884 333.009 207.704 330.097C206.89 328.075 206.156 326.044 205.496 323.965C205.129 322.888 204.711 321.852 204.265 320.805C203.417 318.79 202.616 316.76 201.828 314.721C199.227 307.998 196.355 301.412 193.327 294.871C192.752 293.629 192.18 292.385 191.609 291.142C187.017 281.018 187.017 281.018 181.664 271.289C180 268.467 180 268.467 180 267.375C179.629 267.375 179.257 267.375 178.875 267.375C178.672 266.956 178.469 266.538 178.26 266.107C177.496 264.58 176.657 263.109 175.795 261.635C168.623 249.357 163.317 235.345 166.195 220.875C166.825 218.53 167.709 216.315 168.75 214.125C168.903 213.786 169.055 213.448 169.213 213.099C172.819 205.759 180.091 200.761 187.617 198.07C195.21 195.731 202.757 195.268 210.375 197.625Z"
          fill="none"
          stroke="currentColor"
          strokeWidth="75"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </g>
    </svg>
  )
}

function MenuIcon(props) {
  return (
    <svg
      viewBox="0 0 24 24"
      fill="currentColor"
      {...props}
    >
      <circle cx="5.5" cy="12" r="1.4" />
      <circle cx="12" cy="12" r="1.4" />
      <circle cx="18.5" cy="12" r="1.4" />
    </svg>
  )
}
